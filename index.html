<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Index Page</title>
</head>

<body>
    <h1> Welcome to Josh's Page!</h1>
    <p>Click the link below to learn more about DES:</p>
    <!-- 添加锚点链接 -->
    <a href="./src/symmetric%20key/DES.md" target="_blank">DES</a>
    <pre>
        > # Data Encryption Standard (DES)

## DES设计参数

* 块（明文和密文）长度为64位
* 主密钥长度为64位
  * 但其中8位是奇偶校验位，所以有效密钥长度是56位。
* DES由16轮构成，每轮使用一个由主密钥派生出的循环密钥（也叫子密钥）
  * 子密钥长度为48位，从56位密钥通过**密钥调度**派生而来。



## DES操作符号

* 位串块的循环移位：用 **b<<<n** 表示块b的位向左移动n。本来会掉下出去的位被添加到b的右侧。

  * 如：
    $$
    11000011 <<< 3 = 00011110
    $$
    

* 位的位置排列：写成输入位的输出顺序。
  * 如，排列4123表示：
    * 第四个输入位成为第一输出位
    * 第一个输入位成为第二输出位
    * 第二个输入位成为第三输出位
    * 第三个输入位成为第四输出位
  * 我们使用 “排列”一词来表示位的重新排列，其中包括位的重复或丢弃，尽管这并不是一种正确的排列。
    * 4122



## 加密

<img src="D:\MSCs\LM Network Security & Cryptography\DES\DES Overview.png" style="zoom: 50%;" />

1. 初始置换（IP）

2. 每一轮的操作
   - 将输入分成两等份M = (L<sub>0</sub>,R<sub>0</sub>)

   - 对右半部分应用费斯妥函数 

   - 将结果与旧的左半部计算异或，成为新的左半部

   - 交换旧的右半部分和新的左半部分，除非我们处于最后一轮

     

     意即：

     对于每一轮
     $$
     i = 1,2,...,16
     $$
     计算
     $$
     L_i =& R_{i-1} \\
     R_i =& L_{i-1} \oplus F(K_i, R_{i-1})
     $$
     最后得到C = (R<sub>16</sub>, L<sub>16</sub>)

3. 最终置换（FP或IP<sup>-1</sup>）



## 解密

与加密一样，但子密钥顺序相反

1. 最终置换（FP或IP<sup>-1</sup>）

2. 每一轮的操作

   * 将输入分成两等份C = (R<sub>16</sub>，L<sub>16</sub>)

   * 对于每一轮

   $$
   i = 16，15，...，1
   $$

   ​     计算
   $$
   R_{i-1} =& L_{i} \\
   L_{i-1} =& R_{i} \oplus F(K_i, L_{1})
   $$

   ------

   > ​     加密公式

   $$
   L_i =& R_{i-1} \\
   R_i =& L_{i-1} \oplus F(K_i, R_{i-1})
   $$

   

3. 初始置换（IP）



## 密钥调度

每一轮都有不同的密钥，由所谓的密钥调度计算得出

<img src="D:\MSCs\LM Network Security & Cryptography\DES\DES-key-schedule.png" alt="DES-key-schedule"  />

* 首先对主密钥应用 PC-1 排列，去掉奇偶校验位。这样就得到了 56 比特
* 将结果分成两等分，得到 (C<sub>0</sub>,D<sub>0</sub>)
* 对于每一轮

$$
i = 1,2,...,16
$$

​       计算
$$
C_i =& C_{i-1} <<< p_{i} \\
D_i =& D_{i-1} <<< p_{i}
$$
​       其中
$$
p_i=
\begin{cases}
    1 & \text{如果 } i = 1,2,9,16 \\
    2 & \text{否则 }
\end{cases}
$$

- 现在，我们将 C<sub>i</sub> 和 D<sub>i</sub> 连接在一起，并应用一个产生 48 位输出的排列PC-2产生 48 位输出，得到 K<sub>i</sub>


## 费斯妥函数

<img src="D:\MSCs\LM Network Security & Cryptography\DES\DES-f-function.png" alt="DES-f-function" style="zoom: 150%;" />

1. 扩张置换（E函数）

   * 通过将 16 个位加倍并排列，将 32 位半块扩展为 48 位块

2. 子密钥加

   * 计算子密钥与这个48位块的异或

3. [S盒](https://zh.wikipedia.org/wiki/DES%E8%A1%A5%E5%85%85%E6%9D%90%E6%96%99#%E7%BD%AE%E6%8D%A2%E7%9B%92_(S%E7%9B%92))

   * 将 48 位分割成 8 个 6 位块。将 6 位块分别输入 8 个置换盒，由 4 位块置换出 6 位块。

   * DES的非线性操作，DES的核心

     * 什么是线性？
       $$
       f（a+b）=f(a)+f(b)
       $$

   * S盒是一个查找表，输入为6位，输出为4位。

     * 工作原理

       * 取出第一位和最后一位并连接它们，这个两位数字是行索引
       * 四个内部位表示列号

       * 输出是表中相应的条目

   *  ~~它包括以下约束条件：~~

     * ~~任何一个输出位都不应过于接近输入位的线性组合~~
     * ~~如果 S 盒的两个输入位正好相差一个位，那么它们的输出位必须至少相差两个位~~
     * ~~如果 S盒 的两个输入位在中间两个位上不同，那么它们的输出位必须至少在两个位上不同~~
     * ~~如果 S 盒的两个输入在前两个位上不同，而在后两个位上相同，则 S 盒的输出必须至少有两个位不同。~~

4. P盒

   * 将这 8 个 4 位数据块合并为 32 位数据块，再进行一次排列。

## 混淆和扩散

* 混淆：密文的每个位都应取决于密钥的多个部分，从而模糊了两者之间的联系
* 扩散：如果我们改变明文的一个位，那么（从统计学角度看）密文中一半的位都应该改变
    </pre>
</body>

</html>